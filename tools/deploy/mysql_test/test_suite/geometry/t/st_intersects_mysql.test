#owner: ht353245
#owner group: shenzhen
--echo # ----------------------------------------------------------------------
--echo # Test of GEOMETRY ST_Intersects.
--echo # ----------------------------------------------------------------------

--source mysql_test/test_suite/geometry/t/import_default_srs_data_mysql.inc

  --disable_warnings
	drop table if exists gis_geometrycollection, gis_geometrycollection_2, tbl_polygon, t1, gis_polygon;
	--enable_warnings

  CREATE TABLE gis_geometrycollection (fid INTEGER NOT NULL PRIMARY KEY, g GEOMETRY);

  --echo prepare data for test
  # Geometric elements constructing a star and some of its elememts as base
  SET @star_elem_vertical= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
  SET @star_elem_horizontal= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
  SET @star_center= 'POINT(15 10)';
  SET @star_top= 'POINT(15 25)';
  SET @star_bottom_left= 'POINT(5 0)';
  SET @star_bottom_right= 'POINT(25 0)';
  SET @star_bottom_points= 'MULTIPOINT(5 0,25 0)';
  SET @star_all_points= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
  SET @star_line_horizontal= 'LINESTRING(10 15,20 15)';
  SET @star_line_vertical= 'LINESTRING(15 5,15 25)';
  SET @star_top_to_center= 'LINESTRING(15 25,15 10)';
  SET @star_lines_near_horizontal= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
  SET @star_lines_near_vertical= 'MULTILINESTRING((0 5,15 25,0 25))';
  SET @star= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
  SET @star_elem_vertical_val= '((5 0,15 25,25 0,15 5,5 0))';
  SET @star_elem_horizontal_val= '((25 0,0 15,30 15,22 10,25 0))';
  SET @star_of_elems='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
  SET @star_collection_elems='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';
  SET @star_collection_multilinestr='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),MULTILINESTRING((25 0,0 15,15 30,0 5)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

  # Star identical to the base star 
  SET @star_elem_vertical_1= 'POLYGON((5 0,15 25,25 0,15 5,5 0))';
  SET @star_elem_horizontal_1= 'POLYGON((25 0,0 15,30 15,22 10,25 0))';
  SET @star_center_1= 'POINT(15 10)';
  SET @star_top_1= 'POINT(15 25)';
  SET @star_bottom_left_1= 'POINT(5 0)';
  SET @star_bottom_right_1= 'POINT(25 0)';
  SET @star_bottom_points_1= 'MULTIPOINT(5 0,25 0)';
  SET @star_all_points_1= 'MULTIPOINT(5 0,25 0,15 10,15 25)';
  SET @star_line_horizontal_1= 'LINESTRING(10 15,20 15)';
  SET @star_line_vertical_1= 'LINESTRING(15 5,15 25)';
  SET @star_top_to_center_1= 'LINESTRING(15 25,15 10)';
  SET @star_lines_near_horizontal_1= 'MULTILINESTRING((25 0,0 15,15 30,0 5))';
  SET @star_lines_near_vertical_1= 'MULTILINESTRING((0 5,15 25,0 25))';
  SET @star_1= 'POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0))';
  SET @star_elem_vertical_val_1= '((5 0,15 25,25 0,15 5,5 0))';
  SET @star_elem_horizontal_val_1= '((25 0,0 15,30 15,22 10,25 0))';
  SET @star_of_elems_1='MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0)))';
  SET @star_collection_elems_1='GEOMETRYCOLLECTION(MULTIPOLYGON(((5 0,15 25,25 0,15 5,5 0)),((25 0,0 15,30 15,22 10,25 0))),POLYGON((5 0,7 10,0 15,10 15,15 25,20 15,30 15,22 10,25 0,15 5,5 0)),LINESTRING(15 25,15 10),MULTIPOINT(5 0,25 0),POINT(15 25))';

  # Star like the base star, but shifted to right by 10 on X to overlap base star
  SET @star_elem_vertical_2= 'POLYGON((15 0,25 25,35 0,25 5,15 0))';
  SET @star_elem_horizontal_2= 'POLYGON((35 0,10 15,40 15,32 10,35 0))';
  SET @star_center_2= 'POINT(25 10)';
  SET @star_top_2= 'POINT(25 25)';
  SET @star_bottom_left_2= 'POINT(15 0)';
  SET @star_bottom_right_2= 'POINT(35 0)';
  SET @star_bottom_points_2= 'MULTIPOINT(15 0,35 0)';
  SET @star_all_points_2= 'MULTIPOINT(15 0,35 0,35 10,25 25)';
  SET @star_line_horizontal_2= 'LINESTRING(20 15,30 15)';
  SET @star_line_vertical_2= 'LINESTRING(25 5,25 25)';
  SET @star_top_to_center_2= 'LINESTRING(25 25,25 10)';
  SET @star_lines_near_horizontal_2= 'MULTILINESTRING((35 0,10 15,25 30,10 5))';
  SET @star_lines_near_vertical_2= 'MULTILINESTRING((10 5,25 25,10 25))';
  SET @star_2= 'POLYGON((15 0,17 10,10 15,20 15,25 25,30 15,40 15,32 10,35 0,25 5,15 0))';
  SET @star_elem_vertical_val_2= '((15 0,25 25,35 0,25 5,15 0))';
  SET @star_elem_horizontal_val_2= '((35 0,10 15,40 15,32 10,35 0))';
  SET @star_of_elems_2='MULTIPOLYGON(((15 0,25 25,35 0,25 5,15 0)),((35 0,10 15,40 15,32 10,35 0)))';
  SET @star_collection_elems_2='GEOMETRYCOLLECTION(MULTIPOLYGON(((15 0,25 25,35 0,25 5,15 0)),((35 0,10 15,40 15,32 10,35 0))),POLYGON((15 0,17 10,10 15,20 15,25 25,30 15,40 15,32 10,35 0,25 5,15 0)),LINESTRING(25 25,25 10),MULTIPOINT(15 0,35 0),POINT(25 25))';

  # Star like the base star, but shifted to right by 60 on X to be completly separate
  SET @star_elem_vertical_3= 'POLYGON((65 0,75 25,85 0,75 5,65 0))';
  SET @star_elem_horizontal_3= 'POLYGON((85 0,60 15,90 15,82 10,85 0))';
  SET @star_center_3= 'POINT(75 10)';
  SET @star_top_3= 'POINT(75 25)';
  SET @star_bottom_left_3= 'POINT(65 0)';
  SET @star_bottom_right_3= 'POINT(85 0)';
  SET @star_bottom_points_3= 'MULTIPOINT(65 0,85 0)';
  SET @star_all_points_3= 'MULTIPOINT(65 0,85 0,75 10,75 25)';
  SET @star_line_horizontal_3= 'LINESTRING(70 15,80 15)';
  SET @star_line_vertical_3= 'LINESTRING(75 5,75 25)';
  SET @star_top_to_center_3= 'LINESTRING(75 25,75 10)';
  SET @star_lines_near_horizontal_3= 'MULTILINESTRING((85 0,60 15,85 30,60 5))';
  SET @star_lines_near_vertical_3= 'MULTILINESTRING((60 5,75 25,60 25))';
  SET @star_3= 'POLYGON((65 0,67 10,60 15,70 15,75 25,80 15,90 15,82 10,85 0,75 5,65 0))';
  SET @star_elem_vertical_val_3= '((65 0,75 25,85 0,75 5,65 0))';
  SET @star_elem_horizontal_val_3= '((85 0,60 15,90 15,82 10,85 0))';
  SET @star_of_elems_3='MULTIPOLYGON(((65 0,75 25,85 0,75 5,65 0)),((85 0,60 15,90 15,82 10,85 0)))';
  SET @star_collection_elems_3='GEOMETRYCOLLECTION(MULTIPOLYGON(((65 0,75 25,85 0,75 5,65 0)),((85 0,60 15,90 15,82 10,85 0))),POLYGON((65 0,67 10,60 15,70 15,75 25,80 15,90 15,82 10,85 0,75 5,65 0)),LINESTRING(75 25,75 10),MULTIPOINT(65 0,85 0),POINT(75 25))';

  --echo #INSERT base star
  --disable_warnings
  INSERT INTO gis_geometrycollection VALUES
  (100,ST_GEOMFROMTEXT(@star)),
  (101,ST_GEOMFROMTEXT(@star_elem_vertical)),
  (102,ST_GEOMFROMTEXT(@star_elem_horizontal)),
  (103,ST_GEOMFROMTEXT(@star_of_elems)),
  (104,ST_GEOMFROMTEXT(@star_top)),
  (105,ST_GEOMFROMTEXT(@star_center)),
  (106,ST_GEOMFROMTEXT(@star_bottom_left)),
  (107,ST_GEOMFROMTEXT(@star_bottom_right)),
  (108,ST_GEOMFROMTEXT(@star_bottom_points)),
  (109,ST_GEOMFROMTEXT(@star_all_points)),
  (110,ST_GEOMFROMTEXT(@star_line_horizontal)),
  (111,ST_GEOMFROMTEXT(@star_line_vertical)),
  (112,ST_GEOMFROMTEXT(@star_top_to_center)),
  (113,ST_GEOMFROMTEXT(@star_lines_near_horizontal)),
  (114,ST_GEOMFROMTEXT(@star_lines_near_vertical)),
  (115,ST_GEOMFROMTEXT(@star_collection_elems));
  --enable_warnings

  --echo #INSERT identical (to base) star
  --disable_warnings
  INSERT INTO gis_geometrycollection VALUES
  (200,ST_GEOMFROMTEXT(@star_1)),
  (201,ST_GEOMFROMTEXT(@star_elem_vertical_1)),
  (202,ST_GEOMFROMTEXT(@star_elem_horizontal_1)),
  (203,ST_GEOMFROMTEXT(@star_of_elems_1)),
  (204,ST_GEOMFROMTEXT(@star_top_1)),
  (205,ST_GEOMFROMTEXT(@star_center_1)),
  (206,ST_GEOMFROMTEXT(@star_bottom_left_1)),
  (207,ST_GEOMFROMTEXT(@star_bottom_right_1)),
  (208,ST_GEOMFROMTEXT(@star_bottom_points_1)),
  (209,ST_GEOMFROMTEXT(@star_all_points_1)),
  (210,ST_GEOMFROMTEXT(@star_line_horizontal_1)),
  (211,ST_GEOMFROMTEXT(@star_line_vertical_1)),
  (212,ST_GEOMFROMTEXT(@star_top_to_center_1)),
  (213,ST_GEOMFROMTEXT(@star_lines_near_horizontal_1)),
  (214,ST_GEOMFROMTEXT(@star_lines_near_vertical_1)),
  (215,ST_GEOMFROMTEXT(@star_collection_elems_1));
  --enable_warnings

  --echo #INSERT overlapping star
  --disable_warnings
  INSERT INTO gis_geometrycollection VALUES
  (300,ST_GEOMFROMTEXT(@star_2)),
  (301,ST_GEOMFROMTEXT(@star_elem_vertical_2)),
  (302,ST_GEOMFROMTEXT(@star_elem_horizontal_2)),
  (303,ST_GEOMFROMTEXT(@star_of_elems_2)),
  (304,ST_GEOMFROMTEXT(@star_top_2)),
  (305,ST_GEOMFROMTEXT(@star_center_2)),
  (306,ST_GEOMFROMTEXT(@star_bottom_left_2)),
  (307,ST_GEOMFROMTEXT(@star_bottom_right_2)),
  (308,ST_GEOMFROMTEXT(@star_bottom_points_2)),
  (309,ST_GEOMFROMTEXT(@star_all_points_2)),
  (310,ST_GEOMFROMTEXT(@star_line_horizontal_2)),
  (311,ST_GEOMFROMTEXT(@star_line_vertical_2)),
  (312,ST_GEOMFROMTEXT(@star_top_to_center_2)),
  (313,ST_GEOMFROMTEXT(@star_lines_near_horizontal_2)),
  (314,ST_GEOMFROMTEXT(@star_lines_near_vertical_2)),
  (315,ST_GEOMFROMTEXT(@star_collection_elems_2));
  --enable_warnings

  --echo #INSERT separate star
  --disable_warnings
  INSERT INTO gis_geometrycollection VALUES
  (400,ST_GEOMFROMTEXT(@star_3)),
  (401,ST_GEOMFROMTEXT(@star_elem_vertical_3)),
  (402,ST_GEOMFROMTEXT(@star_elem_horizontal_3)),
  (403,ST_GEOMFROMTEXT(@star_of_elems_3)),
  (404,ST_GEOMFROMTEXT(@star_top_3)),
  (405,ST_GEOMFROMTEXT(@star_center_3)),
  (406,ST_GEOMFROMTEXT(@star_bottom_left_3)),
  (407,ST_GEOMFROMTEXT(@star_bottom_right_3)),
  (408,ST_GEOMFROMTEXT(@star_bottom_points_3)),
  (409,ST_GEOMFROMTEXT(@star_all_points_3)),
  (410,ST_GEOMFROMTEXT(@star_line_horizontal_3)),
  (411,ST_GEOMFROMTEXT(@star_line_vertical_3)),
  (412,ST_GEOMFROMTEXT(@star_top_to_center_3)),
  (413,ST_GEOMFROMTEXT(@star_lines_near_horizontal_3)),
  (414,ST_GEOMFROMTEXT(@star_lines_near_vertical_3)),
  (415,ST_GEOMFROMTEXT(@star_collection_elems_3));
  --enable_warnings

  CREATE TABLE gis_geometrycollection_2 SELECT fid as fid2,g as g2 FROM gis_geometrycollection;

  --echo #####################################################################################
  --echo # ST_INTERSECTS(g1,g2)
  --echo #####################################################################################

  --echo #====================================================================================
  --echo # point,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_center),ST_GEOMFROMTEXT(@star_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_center));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_center)) FROM gis_geometrycollection WHERE fid=105;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('POINT(0 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('POINT(10 0)'));

  --echo #====================================================================================
  --echo # point,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_bottom_left),ST_GEOMFROMTEXT(@star_bottom_points));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_bottom_points));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=106;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0,10 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 0)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0,5 0,10 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(10 0)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0,5 0,10 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 0)'),ST_GEOMFROMTEXT('MULTIPOINT(0 0,5 0,10 0)'));

  --echo #====================================================================================
  --echo # point,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_top_to_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_line_horizontal));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=104;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 0,20 0)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 0)'));

  --echo #====================================================================================
  --echo # point,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_lines_near_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_lines_near_horizontal));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=104;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('MULTILINESTRING((0 0,10 0))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(10 0)'),ST_GEOMFROMTEXT('MULTILINESTRING((0 0,5 0),(5 0,10 0))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 0)'),ST_GEOMFROMTEXT('MULTILINESTRING((0 0,5 0,10 0))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 0)'),ST_GEOMFROMTEXT('MULTILINESTRING((0 0,5 0),(5 0,10 0))'));

  --echo #====================================================================================
  --echo # point,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_elem_horizontal));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_elem_vertical));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star)) FROM gis_geometrycollection WHERE fid=104;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 0)'),ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 5)'),ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0),(4 4,4 6,6 6,6 4,4 4))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 20)'),ST_GEOMFROMTEXT('POLYGON((0 0,10 0,10 10,0 10,0 0))'));

  --echo #====================================================================================
  --echo # point,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(-0.01 0)'),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=104;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0)))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 20)'),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0)),((10 10,10 20,20 20,20 10,10 10)))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 5)'),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 20)'),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,10 0,10 10,0 10,0 0),(4 4,4 6,6 6,6 4,4 4)))'));

  --echo #====================================================================================
  --echo # point,geometrycollection
  --echo #====================================================================================

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(-0.01 0)'),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=104;
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_collection_multilinestr));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 5)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 5)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(5 5))'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(5 5)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(MULTIPOINT(0 0,5 5,10 10),GEOMETRYCOLLECTION())'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(0 0)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,10 0,10 10,0 10,0 0))))'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(20 20)'),ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POLYGON((0 0,10 0,10 10,0 10,0 0))))'));

  --echo #====================================================================================
  --echo # multipoint,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_top));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_bottom_points),ST_GEOMFROMTEXT(@star_center));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_left)) FROM gis_geometrycollection WHERE fid=108;

  --echo #====================================================================================
  --echo # multipoint,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_bottom_points));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_bottom_points),ST_GEOMFROMTEXT(@star_all_points));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_all_points)) FROM gis_geometrycollection WHERE fid=208;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_all_points)) FROM gis_geometrycollection WHERE fid=308;

  --echo #====================================================================================
  --echo # multipoint,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_top_to_center));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=109;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=209;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=309;

  --echo #====================================================================================
  --echo # multipoint,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_lines_near_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_lines_near_horizontal));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_horizontal)) FROM gis_geometrycollection WHERE fid=109;

  --echo #====================================================================================
  --echo # multipoint,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_elem_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_elem_horizontal));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_horizontal)) FROM gis_geometrycollection WHERE fid=109;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_horizontal)) FROM gis_geometrycollection WHERE fid=209;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_horizontal)) FROM gis_geometrycollection WHERE fid=309;

  --echo #====================================================================================
  --echo # multipoint,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('MULTIPOINT(0 0,0 30,30 25)'),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=109;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=209;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=309;

  --echo #====================================================================================
  --echo # multipoint,geometrycollection
  --echo #====================================================================================

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('MULTIPOINT(0 0,0 30,30 25)'),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=109;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=209;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=309;
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_all_points),ST_GEOMFROMTEXT(@star_collection_multilinestr));

  --echo #====================================================================================
  --echo # linestring,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_bottom_left));

  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=110 and fid2=105;

  --echo #====================================================================================
  --echo # linestring,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_vertical),ST_GEOMFROMTEXT('MULTIPOINT(15 10,15 25)'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_vertical),ST_GEOMFROMTEXT(@star_all_points));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT('MULTIPOINT(15 10,15 25)')) FROM gis_geometrycollection WHERE fid=111;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT('MULTIPOINT(15 10,15 25)')) FROM gis_geometrycollection WHERE fid=311;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT('MULTIPOINT(15 10,15 25)')) FROM gis_geometrycollection WHERE fid=411;

  --echo #====================================================================================
  --echo # linestring,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_vertical),ST_GEOMFROMTEXT(@star_top_to_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top_to_center),ST_GEOMFROMTEXT(@star_line_vertical));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=111;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=311;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=411;

  --echo #====================================================================================
  --echo # linestring,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_lines_near_horizontal));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_lines_near_vertical));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_horizontal)) FROM gis_geometrycollection WHERE fid=110;

  --echo #====================================================================================
  --echo # linestring,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT('POLYGON((11 15,19 15,19 10,11 15))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_elem_horizontal));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_elem_horizontal_2));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_elem_horizontal_3));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT('POLYGON((11 15,19 15,19 25,11 15,11 15))')) FROM gis_geometrycollection WHERE fid=110;

  --echo #====================================================================================
  --echo # linestring,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT('MULTIPOLYGON(((11 15,19 15,19 25,11 15,11 15)),((25 0,0 15,25 10,25 0)))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_of_elems_2));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_of_elems_3));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT('MULTIPOLYGON(((11 15,19 15,19 25,11 15,11 15)),((25 0,0 15,25 10,25 0)))')) FROM gis_geometrycollection WHERE fid=110;

  --echo #====================================================================================
  --echo # linestring,geometrycollection
  --echo #====================================================================================

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_collection_elems_2));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_collection_elems_3));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=110;
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_line_horizontal),ST_GEOMFROMTEXT(@star_collection_multilinestr));

  --echo #====================================================================================
  --echo # multilinestring,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_top));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_center_2));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_center_3));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top)) FROM gis_geometrycollection WHERE fid=114;

  --echo #====================================================================================
  --echo # multilinestring,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_bottom_points));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_all_points));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=114;

  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=114 and fid2=108;

  --echo #====================================================================================
  --echo # multilinestring,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_line_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_line_horizontal));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_line_horizontal_2));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_line_horizontal_3));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=114;

  --echo #====================================================================================
  --echo # multilinestring,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT('MULTILINESTRING((0 5,15 25,0 15))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_lines_near_horizontal));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_lines_near_horizontal_3));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT('MULTILINESTRING((0 5,15 25,0 15))')) FROM gis_geometrycollection WHERE fid=114;

  --echo #====================================================================================
  --echo # multilinestring,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_elem_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_elem_horizontal));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_elem_horizontal_2));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_elem_horizontal_3));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=114;

  --echo #====================================================================================
  --echo # multilinestring,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('MULTILINESTRING((0 25,25 0,25 30))'),ST_GEOMFROMTEXT(@star_elem_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=114;

  --echo #====================================================================================
  --echo # multilinestring,geometrycollection
  --echo #====================================================================================

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('MULTILINESTRING((0 25,25 0,25 30))'),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_lines_near_vertical),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=114;

  --echo #====================================================================================
  --echo # polygon,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT('POINT(0 0)'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_center)) FROM gis_geometrycollection WHERE fid=100;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_center)) FROM gis_geometrycollection WHERE fid=200;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_center)) FROM gis_geometrycollection WHERE fid=300;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_center)) FROM gis_geometrycollection WHERE fid=400;

  --echo #====================================================================================
  --echo # polygon,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_all_points));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT('MULTIPOINT(0 0,30 25)'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_all_points)) FROM gis_geometrycollection WHERE fid=100;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_all_points)) FROM gis_geometrycollection WHERE fid=300;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_all_points)) FROM gis_geometrycollection WHERE fid=400;

  --echo #====================================================================================
  --echo # polygon,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_line_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_line_horizontal));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=100;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=300;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_line_vertical)) FROM gis_geometrycollection WHERE fid=400;

  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=100 and fid2=111;

  --echo #====================================================================================
  --echo # polygon,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_lines_near_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_lines_near_horizontal));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=100;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=300;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=400;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((0 0,0 10,10 10,10 0,0 0,0 0),(2 2,2 4,4 4,4 2,2 2))'),
                      ST_GEOMFROMTEXT('MULTILINESTRING((11 11,20 20),(5 7, 4 1))'));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((5 0,0 5,-5 0,0 -5,5 0))'),
                      ST_GEOMFROMTEXT('MULTILINESTRING((10 0, 18 12),(2 2, 2 1))'));

  --echo #====================================================================================
  --echo # polygon,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_elem_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=100;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=300;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=400;

  --echo #====================================================================================
  --echo # polygon,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=100;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=300;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=400;

  --echo #====================================================================================
  --echo # polygon,goemetrycollection
  --echo #====================================================================================

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_elem_vertical),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=100;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=300;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=400;
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star),ST_GEOMFROMTEXT(@star_collection_multilinestr));

  --echo #====================================================================================
  --echo # multipolygon,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_top));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT('POINT(30 30)'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top)) FROM gis_geometrycollection WHERE fid=103;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top)) FROM gis_geometrycollection WHERE fid=403;

  --echo #====================================================================================
  --echo # multipolygon,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_bottom_points));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT('MULTIPOINT(30 30,0 35)'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=103;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=403;

  --echo #====================================================================================
  --echo # multipolygon,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_top_to_center));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT('LINESTRING(30 30,0 35)'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=103;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=403;

  --echo #====================================================================================
  --echo # multipolygon,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_lines_near_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT('MULTILINESTRING((0 30,30 30,0 35))'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=103;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=403;

  --echo #====================================================================================
  --echo # multipolygon,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_elem_vertical));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT('POLYGON((0 0,15 25,35 0,0 0,0 0))'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=103;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=303;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=403;

  --echo #====================================================================================
  --echo # multipolygon,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_of_elems));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,15 25,35 0,0 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=103;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=303;

  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_of_elems)) FROM gis_geometrycollection WHERE fid=403;

  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

  --echo #====================================================================================
  --echo # multipolygon,geometrycollection
  --echo #====================================================================================

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=103;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=303;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=403;
  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=115;


  --echo #====================================================================================
  --echo # geometrycollection,point
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_top));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('POINT(30 30)'));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top)) FROM gis_geometrycollection WHERE fid=415;

  --echo #====================================================================================
  --echo # geometrycollection,multipoint
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_bottom_points));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('MULTIPOINT(30 30,0 35)'));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_bottom_points)) FROM gis_geometrycollection WHERE fid=415;

  --echo #====================================================================================
  --echo # geometrycollection,linestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_top_to_center));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('LINESTRING(30 30,0 35)'));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_top_to_center)) FROM gis_geometrycollection WHERE fid=415;

  --echo #====================================================================================
  --echo # geometrycollection,multilinestring
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_lines_near_vertical));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('MULTILINESTRING((0 30,30 30,0 35))'));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_lines_near_vertical)) FROM gis_geometrycollection WHERE fid=415;

  --echo #====================================================================================
  --echo # geometrycollection,polygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_elem_vertical));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('POLYGON((0 0,15 25,35 0,0 0,0 0))'));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=315;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_elem_vertical)) FROM gis_geometrycollection WHERE fid=415;

  --echo #====================================================================================
  --echo # geometrycollection,multipolygon
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_of_elems));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT('MULTIPOLYGON(((0 0,15 25,35 0,0 0,0 0),(5 0,15 25,25 0,15 5,5 0)))'));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=315;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=415;
  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=115;

  --echo #====================================================================================
  --echo # geometrycollection,geometrycollection
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_collection_elems));
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=115;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=315;
  SELECT ST_INTERSECTS(g,ST_GEOMFROMTEXT(@star_collection_elems)) FROM gis_geometrycollection WHERE fid=415;
  SELECT ST_INTERSECTS(g,g2) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=115 and fid2=115;
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_collection_elems),ST_GEOMFROMTEXT(@star_collection_multilinestr));

  # tests with srid
  --echo #====================================================================================
  --echo # ST_INTERSECTS(g1,g2)
  --echo #====================================================================================
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,0),ST_GEOMFROMTEXT(@star_center,0));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4145),ST_GEOMFROMTEXT(@star_center,4145));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4326),ST_GEOMFROMTEXT(@star_center,4326));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4135),ST_GEOMFROMTEXT(@star_center,4135));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4145),ST_GEOMFROMTEXT(@star_center,4145));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4326),ST_GEOMFROMTEXT(@star_center,4326));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4135),ST_GEOMFROMTEXT(@star_center,4135));

  # test srid with same points

  --error ER_DATA_OUT_OF_RANGE
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,-1),ST_GEOMFROMTEXT(@star_center,-1));

  --error ER_DATA_OUT_OF_RANGE
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,-1024),ST_GEOMFROMTEXT(@star_center,-1024));

  --error ER_DATA_OUT_OF_RANGE
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4294967295000),ST_GEOMFROMTEXT(@star_center,4294967295000));

  --echo #####################################################################################
  --echo # Invalid function calls
  --echo #####################################################################################

  --echo #====================================================================================
  --echo # ST_INTERSECTS(g1,g2)
  --echo #====================================================================================

  --error ER_GIS_DIFFERENT_SRIDS
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top),ST_GEOMFROMTEXT(@star_center,4326));

  --error ER_GIS_DIFFERENT_SRIDS
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4145),ST_GEOMFROMTEXT(@star_center,4326));

  --error ER_GIS_DIFFERENT_SRIDS
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_top,4145),ST_GEOMFROMTEXT(@star_center,4326));

  SELECT ST_INTERSECTS(NULL,ST_GEOMFROMTEXT(@star_top));

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),NULL);

  SELECT ST_INTERSECTS(g,NULL) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

  SELECT ST_INTERSECTS(NULL,NULL);

  # mysql result is null
  SELECT ST_INTERSECTS(fid,NULL) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;

  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(fid,ST_GEOMFROMTEXT(@star_top)) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),fid) FROM gis_geometrycollection,gis_geometrycollection_2 WHERE fid=103 and fid2=103;
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(a 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(! 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_PARSE_ERROR
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT('!' 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(12,34 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING(a 0,10 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING(0 0,! 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_PARSE_ERROR
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING('!' 0,10 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING(12,34 0,10 10)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((a 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((0 0,! 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_PARSE_ERROR
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON(('!' 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((12,34 0,10 10,10 0,0 0))'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_GIS_INVALID_DATA
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((12,34 0,10 10,10 0,0 0)'),ST_GEOMFROMTEXT('LINESTRING(0 0,10 10)'));
  --error ER_PARSE_ERROR
  SELECT ST_INTERSECTS(,);
  --error ER_PARSE_ERROR
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT(@star_of_elems),);
  --error ER_PARSE_ERROR
  SELECT ST_INTERSECTS(,ST_GEOMFROMTEXT(@star_top));

  --echo # SRID 0 (should pass)
  SELECT ST_INTERSECTS(
    ST_GEOMFROMTEXT('POINT(0 0)', 0),
    ST_GEOMFROMTEXT('POINT(0 0)', 0)
  );

  --echo # Projected SRS (should pass)
  SELECT ST_INTERSECTS(
    ST_GEOMFROMTEXT('POINT(0 0)', 2000),
    ST_GEOMFROMTEXT('POINT(0 0)', 2000)
  );

  --echo # Geographic SRS (should pass)
  SELECT ST_INTERSECTS(
    ST_GEOMFROMTEXT('POINT(0 0)', 4326),
    ST_GEOMFROMTEXT('POINT(0 0)', 4326)
  );

  --echo #
  --echo # WL#10827 Ellipsoidal R-tree support functions
  --echo #

  SET @pt = ST_GeomFromText('POINT(0 0)', 4326);

  # SRID=4326, long=0, lat=-91.
  SET @pt_lat_minus_91 = x'E6100000010100000000000000000000000000000000C056C0';

  # SRID=4326, long=0, lat=91.
  SET @pt_lat_plus_91 = x'E6100000010100000000000000000000000000000000C05640';

  # SRID=4326, long=-181, lat=0.
  SET @pt_long_minus_181 = x'E610000001010000000000000000A066C00000000000000000';

  # SRID=4326, long=181, lat=0.
  SET @pt_long_plus_181 = x'E610000001010000000000000000A066400000000000000000';

  #fix: validate wkb input
  #--error ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE
  #SELECT ST_Intersects(@pt_lat_minus_91, @pt);
  #--error ER_GEOMETRY_PARAM_LATITUDE_OUT_OF_RANGE
  #SELECT ST_Intersects(@pt_lat_plus_91, @pt);
  #--error ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE
  #SELECT ST_Intersects(@pt_long_minus_181, @pt);
  #--error ER_GEOMETRY_PARAM_LONGITUDE_OUT_OF_RANGE
  #SELECT ST_Intersects(@pt_long_plus_181, @pt);

  #fix srid in create table generated column, expr st_srid
  #CREATE TABLE t1 (
  #  id INT,
  #  c GEOMETRY NOT NULL SRID 0,
  #  g GEOMETRY AS (ST_SRID(c, 4326)) STORED NOT NULLst_srid SRID 4326,
  #  SPATIAL INDEX c_idx (c),
  #  SPATIAL INDEX g_idx (g)
  #);
 
  #INSERT INTO t1 (id, c) VALUES
  #  (0, ST_GeomFromText('POINT(0 0)')),
  #  (1, ST_GeomFromText('POINT(1 1)')),
  #  (2, ST_GeomFromText('POINT(2 2)')),
  #  (3, ST_GeomFromText('POINT(3 3)')),
  #  (4, ST_GeomFromText('POINT(4 4)')),
  #  (5, ST_GeomFromText('POINT(5 5.00001)')),
  #  (6, ST_GeomFromText('POINT(6 6)')),
  #  (7, ST_GeomFromText('POINT(7 7)'));
 
  #SET @py = 'POLYGON((0 0, 10 0, 10 5, 0 5, 0 0))';
  #SET @cart_py = ST_GeomFromText(@py);
  #SET @geo_py = ST_GeomFromText(@py, 4326, 'axis-order=long-lat');
 
  #SET @mpt = 'MULTIPOINT((0 0), (10 5))';
  #SET @cart_mpt = ST_GeomFromText(@mpt);
  #SET @geo_mpt = ST_GeomFromText(@mpt, 4326, 'axis-order=long-lat');
 
  #--echo # Cartesian ST_Intersects
  #SELECT id, ST_AsText(c)
  #  FROM t1 IGNORE INDEX(c_idx)
  #  WHERE ST_Intersects(c, @cart_py)
  #  ORDER BY id;
  #SELECT id, ST_AsText(c)
  #  FROM t1 FORCE INDEX(c_idx)
  #  WHERE ST_Intersects(c, @cart_py)
  #  ORDER BY id;
 
  #--echo # Geographic ST_Intersects
  #SELECT id, ST_AsText(g)
  #  FROM t1 IGNORE INDEX(g_idx)
  #  WHERE ST_Intersects(g, @geo_py)
  #  ORDER BY id;
  #SELECT id, ST_AsText(g)
  #  FROM t1 FORCE INDEX(g_idx)
  #  WHERE ST_Intersects(g, @geo_py)
  #  ORDER BY id;

  drop table gis_geometrycollection, gis_geometrycollection_2;
  #drop table t1;

  --echo #from mysql gis-precise.test
  select 1, ST_Intersects(ST_GeomFromText('POLYGON((0 0,20 0,20 20,0 20,0 0))'), ST_GeomFromText('POLYGON((10 10,30 10,30 30,10 30,10 10))'));
  select 0, ST_Intersects(ST_GeomFromText('POLYGON((0 0,20 10,10 30, 0 0))'), ST_GeomFromText('POLYGON((10 40, 40 50, 20 70, 10 40))'));
  select 1, ST_Intersects(ST_GeomFromText('POLYGON((0 0,20 10,10 30, 0 0))'), ST_GeomFromText('POINT(10 10)'));
  select 1, ST_Intersects(ST_GeomFromText('POLYGON((0 0,20 10,10 30, 0 0))'), ST_GeomFromText('POLYGON((10 10,30 20,20 40, 10 10))'));

  SELECT ST_intersects(ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'),ST_GeomFromText('GEOMETRYCOLLECTION()'));

  set @a=ST_GeomFromText("POLYGON((0 0, 0 10, 10 10, 10 0, 0 0))");
  set @l=ST_GeomFromText('linestring(-2 -2, 12 7)');
  select st_intersects(@a, @l);

  set @l=ST_GeomFromText('linestring(5 5, 15 4)');
  select st_intersects(@a, @l);

  set @l=ST_GeomFromText('linestring(7 6, 15 4)');
  select st_intersects(@a, @l);

  set @l=ST_GeomFromText('linestring(6 2, 12 1)');
  select st_intersects(@a, @l);

  create table tbl_polygon(id varchar(32), geom GEOMETRY);
  insert into tbl_polygon (id, geom) values
  ('POLY1',ST_GeomFromText('POLYGON((0 0,0 10,10 10,10 0,0 0))'));
  insert into tbl_polygon (id, geom) values
  ('POLY2',ST_GeomFromText('POLYGON((0 0,0 -10,10 -10,10 0,0 0))'));

  select 1, st_intersects(t.geom, p.geom)
  from tbl_polygon t, tbl_polygon p
  where t.id = 'POLY1' and p.id = 'POLY2';

  select 1, st_intersects(t.geom, p.geom)
  from tbl_polygon t, tbl_polygon p
  where t.id = 'POLY1' and p.id = 'POLY2';

  select ST_Intersects(ST_GeomFromText('LINESTRING(15 10,10 0)'),ST_GeomFromText('POINT(15 10)')) as result;
  # mysql result is null
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION()'),ST_GEOMFROMTEXT('POINT(0 0)')) as result;
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION())'),ST_GEOMFROMTEXT('POINT(0 0)')) as result;
  drop table tbl_polygon;

  # bugfix: 
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000000100000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'000000000100000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(ST_GeomFromText('point(-10 -20)'),x'00000000000100000000000000000024C000000000000034C0');
  --error ER_GIS_INVALID_DATA
  select st_intersects(ST_GeomFromText('point(-10 -20)'),x'000000000100000000000000000024C000000000000034C0');
  
  # bugfix: 
  --error ER_GIS_DIFFERENT_SRIDS
  select st_intersects(x'00000001010100000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_DIFFERENT_SRIDS
  select st_intersects(ST_GeomFromText('point(-10 -20)'),x'00000001010100000000000000000024C000000000000034C0');
  --error ER_GIS_DIFFERENT_SRIDS
  select st_intersects(x'010100000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_DIFFERENT_SRIDS
  select st_intersects(ST_GeomFromText('point(-10 -20)'),x'010100000000000000000024C000000000000034C0');
  
  # bugfix: 
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010200000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010300000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010400000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010500000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010600000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010700000000000000000024C000000000000034C0',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(x'00000000010100000003000000010100000000000000000024400000000000002440010100000000000000000024C000000000000034C00102000000020000000000000000002E400000000000002E4000000000000034400000000000003440',ST_GeomFromText('point(-10 -20)'));
  --error ER_GIS_INVALID_DATA
  select st_intersects(ST_GeomFromText('MULTILINESTRING((10 10, 20 20), (15 15, 30 15))'),x'0000000001050000000300000001020000000200000000000000000024400000000000002440000000000000344000000000000034400102000000020000000000000000002E400000000000002E400000000000003E400000000000002E40');
  
  # bugfix: 
  --error 1582
  select st_intersects(null,null,null);
  
  # bugfix: 
  select st_intersects(ST_GeomFromText('POLYGON((0 0,10 0,10 10,0 10,0 0))'),x'00000000010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000001');
  select st_intersects(x'00000000010300000001000000050000000000000000000000000000000000000000000000000024400000000000000000000000000000244000000000000024400000000000000000000000000000244000000000000000000000000000000001',ST_GeomFromText('POLYGON((0 0,10 0,10 10,0 10,0 0))'));

  # 
  create table t1(g1 geometry not null srid 4326);
  insert into t1 values(st_geomfromtext('point(-6.124932923690693 23.43701608651873)', 4326));
  insert into t1 values(st_geomfromtext('point(-6.124932923690693 23.43701608651874)', 4326));
  select st_astext(g1) from t1 where st_intersects(st_geomfromtext('point(-6.124932923690693 23.43701608651873)', 4326), g1);
  
  drop table t1;
  create table t1(g1 geometry not null srid 4326);
  create spatial index spidx on t1(g1);
  insert into t1 values(st_geomfromtext('point(-6.124932923690693 23.43701608651873)', 4326));
  insert into t1 values(st_geomfromtext('point(-6.124932923690693 23.43701608651874)', 4326));
  select st_astext(g1) from t1 where st_intersects(st_geomfromtext('point(-6.124932923690693 23.43701608651873)', 4326), g1);
  drop table t1;

  # bugfix : 
  --error 3732
  select st_intersects(cast(x'e6100000010100000000000000008056403333333333836640' as point),ST_GeomFromText('point(10 20)',4326));
  --error 3731
  select st_intersects(ST_GeomFromText('point(10 20)',4326), cast(x'e6100000010100000033333333338366C000000000008056C0' as point));

  # bugfix : 
  create table gis_polygon(pol geometry not null srid 4326, SPATIAL INDEX(pol));
  insert into gis_polygon values(st_geomfromtext('POLYGON((0 0, 0 0.000000001, 0.000000001 0.000000001, 0.000000001 0, 0 0))', 4326));
  insert into gis_polygon values(st_geomfromtext('POLYGON((-0.000000001 0.000000001,-0.000000001 0.000000002,0 0.000000002,0 0.000000001,-0.000000001 0.000000001))', 4326));
  insert into gis_polygon values(st_geomfromtext('POLYGON((0.000000603 0, 0.000000603 0.000000001, 0.000000604 0.000000001, 0.000000604 0, 0.000000603 0))', 4326));
  insert into gis_polygon values(st_geomfromtext('POLYGON((0.000000603 -0.000000001, 0.000000603 0, 0.000000604 0, 0.000000604 -0.000000001, 0.000000603 -0.000000001))', 4326));
  select st_astext(pol) from gis_polygon where st_intersects(pol, st_geomfromtext(' POLYGON((0 0,0 0.000000001,0.000000001 0.000000001,0.000000001 0,0 0))' ,4326));
  select st_astext(pol) from gis_polygon where st_intersects(st_geomfromtext(' POLYGON((0 0,0 0.000000001,0.000000001 0.000000001,0.000000001 0,0 0))' ,4326), pol);
  select st_astext(pol) from gis_polygon ignore index(pol) where st_intersects(pol, st_geomfromtext(' POLYGON((0 0,0 0.000000001,0.000000001 0.000000001,0.000000001 0,0 0))' ,4326));
  drop table gis_polygon;

  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POLYGON((1 1,1 10,10 10,10 1, 1 1))'), 
       ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 20,20 20,20 0, 0 0)))'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING(1 1, 10 10)'), 
       ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 20,20 20,20 0, 0 0)))'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('LINESTRING(1 1, 10 10)'), 
       ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POINT(5 5))'));
  SELECT ST_INTERSECTS(ST_GEOMFROMTEXT('POINT(10 10)'), 
       ST_GEOMFROMTEXT('GEOMETRYCOLLECTION(POLYGON((0 0,0 20,20 20,20 0, 0 0)))'));
  
select st_intersects(ST_GeomFromText('LINESTRING(0 0 0, 10 10 10, 20 25 30, 50 60 -60)',26918),ST_GeomFromText('GEOMETRYCOLLECTION(GEOMETRYCOLLECTION(POINT(10 10 10), POINT(30 30 -30), LINESTRING(15 15 -15, 20 20 30),MULTIPOLYGON(((-1 -1 -1,10 10 0,-10 -20 20,0 -10 0,-1 -1 -1)))))',26918));

select st_intersects(ST_GeomFromText('LINESTRING(0 0, 10 10, 20 25 , 50 60 )'),ST_GeomFromText('point(5 5 )')) ;