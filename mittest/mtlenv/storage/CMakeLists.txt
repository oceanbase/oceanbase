function(ob_mds_case case)
  storage_dml_unittest(${ARGV})
  target_link_libraries(${case} PRIVATE truncate_info_helper -static-libstdc++)
endfunction()

storage_unittest(test_tenant_module_env)
storage_unittest(test_ls_service test_ls_service.cpp)
if(OB_BUILD_SHARED_STORAGE)
  storage_unittest(test_ls_service_ss test_ls_service_ss.cpp)
endif()
storage_dml_unittest(test_write_tablet_slog test_write_tablet_slog.cpp)
storage_dml_unittest(test_table_scan_pure_data_table)
storage_dml_unittest(test_tenant_meta_mem_mgr test_tenant_meta_mem_mgr.cpp)
storage_dml_unittest(test_tablet_status_cache test_tablet_status_cache.cpp)
storage_dml_unittest(test_tablet_member_load_and_free test_tablet_member_load_and_free.cpp)
storage_dml_unittest(test_ls_migration_param test_ls_migration_param.cpp)
storage_dml_unittest(test_ls_tablet_service test_ls_tablet_service.cpp)
storage_dml_unittest(test_tenant_slog_ckpt test_tenant_slog_ckpt.cpp)
if(OB_BUILD_CLOSE_MODULES)
  storage_unittest(test_memtable test_memtable_v2.cpp)
endif()
#storage_dml_unittest(test_lob_manager test_lob_manager.cpp)
storage_unittest(test_trans test_trans.cpp)
storage_dml_unittest(test_ext_file_access test_ext_file_access.cpp)
#storage_unittest(test_ls_restore_task_mgr)
storage_dml_unittest(test_index_sstable_estimator)
storage_dml_unittest(test_index_sstable_multi_estimator)
ob_mds_case(test_medium_info_iterator test_medium_info_iterator.cpp)
ob_mds_case(test_medium_info_reader test_medium_info_reader.cpp)
ob_mds_case(test_truncate_info_reader test_truncate_info_reader.cpp)
storage_dml_unittest(test_ddl_create_tablet test_ddl_create_tablet.cpp)
storage_dml_unittest(test_migration_tablet_param test_migration_tablet_param.cpp)
storage_dml_unittest(test_tablet_mds_data test_tablet_mds_data.cpp)
storage_dml_unittest(test_mds_data_read_write test_mds_data_read_write.cpp)
storage_dml_unittest(test_mds_table_scan test_mds_table_scan.cpp)
storage_dml_unittest(test_mds_compat test_mds_compat.cpp)
storage_dml_unittest(test_empty_shell_handler test_empty_shell_handler.cpp)
storage_unittest(test_physical_copy_task test_physical_copy_task.cpp)
storage_unittest(test_shared_block_reader_writer)
storage_dml_unittest(test_meta_snapshot test_meta_snapshot.cpp)
storage_dml_unittest(test_tablet_aggregated_info test_tablet_aggregated_info.cpp)
# storage_unittest(test_speed_limit test_speed_limit.cpp)
storage_dml_unittest(test_tablet_block_id_list test_tablet_block_id_list.cpp)
storage_dml_unittest(test_ls_tablet_info_writer_and_reader test_ls_tablet_info_writer_and_reader.cpp)
storage_dml_unittest(test_auto_partition_split_range test_auto_partition_split_range.cpp)
#storage_dml_unittest(test_auto_partition_estimate)
#storage_dml_unittest(test_auto_partition_get_read_tables)
#storage_dml_unittest(test_auto_partition_scan_table)
storage_dml_unittest(test_transfer_barrier test_transfer_barrier.cpp)

add_subdirectory(access)
add_subdirectory(checkpoint)
add_subdirectory(blocksstable)
add_subdirectory(tenant_snapshot)
add_subdirectory(tablet_memtable)
add_subdirectory(tmp_file)

target_link_libraries(test_memtable PUBLIC mock_tx_ctx mock_tx_log_adapter)
